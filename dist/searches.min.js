/***
  * ExplorerSearches - Explorer searches components.
  * @version v0.0.1-SNAPSHOT
  * @link http://www.ga.gov.au/
  * @license Copyright 2015 Geoscience Australia (http://www.ga.gov.au/copyright.html)
  */
!function(e,n){"use strict";function t(){var e="service/basinsearch/basins",n={};this.setReferenceUrl=function(n){e=n},this.$get=["$q","$rootScope","$timeout","httpData","searchMapService",function(t,a,o,r,c){var i={load:function(){return r.get(e,{cache:!0}).then(function(e){return n.basins=e.data.basins,n})},zoomToLocation:function(e){function n(){c.goTo(o)}var t=e.bbox,o={type:"Polygon",coordinates:[[t.xMin,t.yMin],[t.xMin,t.yMax],[t.xMax,t.yMax],[t.xMax,t.yMin],[t.xMin,t.yMin]]},r={from:"Basins search",type:"GeoJSONUrl",url:"/explorer-searches-services/service/basinsearch/basin/"+e.id,pan:n,show:!0,name:e.name,polygon:o};a.$broadcast("search.performed",r),n()}};return i}]}e.module("exp.search.basinsearch",[]).directive("basinSearch",["$log","$timeout","basinService",function(e,n,t){return{restrict:"AE",transclude:!0,templateUrl:"searches/basinsearch/basinsearch.html",link:function(a,o){function r(){n.cancel(c),c=n(function(){e.info("Clear filter"),a.nameFilter=""},7e3)}var c;t.load().then(function(e){a.basinData=e}),a.changing=function(){e.info("Cancel close"),n.cancel(c)},a.cancel=r,a.zoomToLocation=function(e){t.zoomToLocation(e),r()}}}}]).provider("basinService",t).filter("basinFilterList",function(){return function(e,n,t){var a,o,r=[];return n?(t||(t=50),a=n.toLowerCase(),e&&(o=0,e.some(function(e){return e.name.toLowerCase().indexOf(a)>-1&&(r.push(e),o++),o>t})),r):r}})}(angular,SearchMapping),function(e,n,t){"use strict";e.module("exp.search.geosearch",["ngAutocomplete"]).directive("geoSearch",["$log","$q","$rootScope","googleService","searchMapService",function(e,n,t,a,o){var r=.1;return{templateUrl:"searches/geosearch/geosearch.html",controller:["$scope",function(n){n.values={from:{}},n.zoom=function(c){n.values.from.description&&a.getAddressDetails(n.values.from.description,n).then(function(a){function c(){o.goTo(d)}var i={type:"Feature",geometry:{type:"Point",coordinates:[a.lat,a.lon]},properties:{name:a.address}},s={from:"Google search",name:a.address,type:"GeoJSONPoint",pan:function(){c()},data:i},l=a.lon-r,u=a.lon+r,h=a.lat-r,f=a.lat+r,d={type:"Polygon",coordinates:[[[l,h],[l,f],[u,f],[u,h],[l,h]]]};return e.debug("Received the results for from"),n.values.from.results=a,a&&(c(),t.$broadcast("search.performed",s)),n.item="",a},function(n){e.debug("Failed to complete the from lookup.")})}}]}}]).factory("googleService",["$log","$q",function(e,t){var a,o=new n.maps.Geocoder;try{a=new n.maps.places.AutocompleteService(null,{types:["geocode"]})}catch(r){e.debug("Catching google error that manifests itself when debugging in Firefox only")}return{getAddressDetails:function(e,a){var r=t.defer();return o.geocode({address:e,region:"au"},function(e,t){t!=n.maps.GeocoderStatus.OK?a.$apply(function(){r.reject("Failed to find address")}):a.$apply(function(){r.resolve({lat:e[0].geometry.location.lat(),lon:e[0].geometry.location.lng(),address:e[0].formatted_address})})}),r.promise}}}])}(angular,google,Cesium),function(e){"use strict";e.module("exp.search.lastsearch",[]).directive("geoLastSearch",["$document","lastSearchService",function(e,n){return{restrict:"AE",transclude:!0,templateUrl:"searches/lastsearch/lastsearch.html",link:function(t,a){function o(e){27==e.which&&(e.stopPropagation(),e.preventDefault(),t.$apply(function(){t.close()}))}t.data=n.data,e.on("keyup",o),t.toggle=function(){(t.data.search.displayed=!t.data.search.displayed)?n.show():n.hide()},t.pan=function(){t.data.search.pan()},t.close=function(){n.clear()}}}}]).factory("lastSearchService",["$log","$rootScope","searchMapService",function(e,n,t){var a,o={search:null},r={show:function(){a.draw()},hide:function(){a&&a.erase()},data:function(){return o},isShowing:function(){a.isDrawn()},clear:function(){this.hide(),o.search=null}};return n.$on("search.performed",function(e,n){a&&a.destroy(),a=t.getDrawer(n),o.search=n,n.show&&a.show()}),r}])}(angular),function(e,n){"use strict";function t(){var e="service/lgasearch/states",n="service/lgasearch/lgas",t={};this.setReferenceUrl=function(e){n=e},this.$get=["$q","$rootScope","$timeout","httpData","searchMapService",function(a,o,r,c,i){var s={load:function(){return c.get(n,{cache:!0}).then(function(e){t.lgas=e.data.lgas}),c.get(e,{cache:!0}).then(function(e){t.states=e.data.states}),a.when(t)},zoomToLocation:function(e){function n(){i.goTo(a)}var t=e.bbox,a={type:"Polygon",coordinates:[[t.xMin,t.yMin],[t.xMin,t.yMax],[t.xMax,t.yMax],[t.xMax,t.yMin],[t.xMin,t.yMin]]},r={from:"LGA search",type:"GeoJSONUrl",url:"/explorer-searches-services/service/basinsearch/basin/"+e.id,pan:n,show:!0,name:e.name,polygon:a};e.id&&o.$broadcast("search.performed",r),n()}};return s}]}e.module("exp.search.lgasearch",[]).directive("lgaSearch",["$log","$timeout","lgaService",function(e,n,t){return{restrict:"AE",transclude:!0,templateUrl:"searches/lgasearch/lgasearch.html",link:function(a,o){function r(){n.cancel(c),c=n(function(){e.info("Clear filter"),a.nameFilter=""},7e3)}var c;t.load().then(function(e){a.lgaData=e}),a.changing=function(){e.info("Cancel close"),n.cancel(c)},a.cancel=r,a.zoomToLocation=function(e){t.zoomToLocation(e),r()}}}}]).provider("lgaService",t).filter("lgaFilterList",function(){return function(e,n,t){var a,o,r=[];return n?(t||(t=50),a=n.toLowerCase(),e&&(o=0,e.some(function(e){return e.name.toLowerCase().indexOf(a)>-1&&(r.push(e),o++),o>t})),r):r}})}(angular,Cesium),function(e){"use strict";e.module("exp.search.searches",[]).directive("searchesSearches",function(){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:"searches/searches/searches.html",scope:{name:"@"},controller:["$scope",function(e){function n(n){e.state.searches.forEach(function(e){e.active=!1}),n.active=!0}e.state={showSearchButton:!0,searches:[]},e["switch"]=function(e){n(e)},this.add=function(n){console.log("Adding"),e.state.searches.push(n)},this.active=function(e){n(e)}}]}}).directive("searchesSearch",function(){return{replace:!0,template:"<div ng-transclude ng-show='active'></div>",transclude:!0,require:"^searchesSearches",scope:{label:"@",active:"=default"},link:function(e,n,t,a){a.add(e)}}})}(angular);
//# sourceMappingURL=searches.min.js.map
